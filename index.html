<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta name="description" content="绝区零伤害公式一览表，包含通用伤害、防御区、直伤伤害、命破伤害、异常伤害等计算公式。" />
    <meta name="theme-color" content="#3498db" />
    <meta name="color-scheme" content="light dark" />
    <title>绝区零伤害公式一览表</title>
    <!-- Polyfill for older browsers (defer for non-blocking) -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es2015" defer></script>

    <!-- MathJax config must load before MathJax script -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <script id="mathjax" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>

    <!-- 相对路径，适配 GitHub Pages/静态托管 -->
    <link rel="stylesheet" href="./style.css">
</head>

<body>
    <div class="header-bar">
        <div class="header-inner">
            <button class="dark-mode-toggle" id="open-changelog">
                <span>📝</span>
                <span class="changelog-text">更新日志</span>
            </button>
            <h1>绝区零伤害公式一览表</h1>
            <button class="dark-mode-toggle" onclick="toggleDarkMode()">
                <span class="mode-icon">🌙</span>
                <span class="mode-text">深色模式</span>
            </button>
        </div>
    </div>

    <!-- 更新日志弹窗 -->
    <div aria-hidden="true" class="overlay" id="changelog-overlay">
        <div class="overlay-content">
            <div class="overlay-header">
                <h2>更新日志</h2>
                <button class="dark-mode-toggle" onclick="toggleDarkMode()">
                    <span class="mode-icon">🌙</span>
                    <span class="mode-text">深色模式</span>
                </button>
            </div>
            <div class="overlay-body">
                <h3 style="text-align:center;margin-bottom:20px;color:var(--primary-color);font-size:1.5rem;">
                    V1.0.0 更新内容
                </h3>
                <div class="info-box">
                    <ol style="margin:0;padding-left:24px;line-height:2;">
                        <li>完整的伤害公式计算参考</li>
                        <li>支持深色/浅色主题切换</li>
                        <li>使用 MathJax 渲染数学公式</li>
                        <li>包含通用伤害、防御区、直伤、命破、异常伤害等内容</li>
                        <li>响应式设计，支持桌面和移动端浏览</li>
                    </ol>
                </div>
                <p style="text-align:right;margin-top:40px;color:var(--text-color);font-size:0.9rem;font-style:italic;">
                    --艾莲其实是爱恋的意思
                </p>
            </div>
        </div>
    </div>

    <main class="container">
        <!-- 通用伤害 -->
        <div class="formula-section">
            <h2>通用伤害</h2>
            <p class="description">
                通用伤害是所有伤害计算的基础。它考虑了基础属性、技能倍率、失衡易伤、增伤、暴击伤害和抗性等因素。
            </p>
            <div class="formula-box">
                <div class="math">
                    $$\begin{align}
                    \text{通用伤害} &= \text{基础属性} \times \text{倍率} \times (1 + \text{失衡易伤}\%)\\
                    \quad &\times (1 + \text{增伤}\% ) \times (1 + \text{暴击伤害}\%) \\
                    \quad &\times (1 - \text{增抗}\% + \text{减抗}\% + \text{抗穿}\%)
                    \end{align}$$
                </div>
            </div>
        </div>

        <!-- 防御区 -->
        <div class="formula-section">
            <h2>防御区</h2>
            <p class="description">
                防御区用于计算敌人的防御效果，影响直伤伤害的最终结算。
            </p>
            <div class="formula-box">
                <div class="math">
                    $$\text{防御区} = \frac{794}{\frac{\text{1级基础防御}}{50} \times 794 \times (1 + \text{加防}\% - \text{减防}\% - \text{无视防御}\%) \times (1 - \text{穿透}\%) - \text{穿透值} + 794}$$
                </div>
            </div>
        </div>

        <!-- 直伤伤害 -->
        <div class="formula-section">
            <h2>直伤伤害</h2>
            <p class="description">
                直伤是游戏中最主要的伤害类型，受防御、易伤和距离衰减的影响。
            </p>
            <div class="formula-box">
                <div class="math">
                    $$\begin{align}
                    \text{直伤伤害} &= \text{通用伤害(攻击力)} \times \text{防御区} \\
                    \quad &\times (1 + \text{易伤}\% - \text{减伤}\% ) \\
                    \quad &\times \text{距离衰减区}
                    \end{align}$$
                </div>
            </div>
            <div class="note">
                <strong>注意：</strong>大部分代理人计算<strong>距离衰减区</strong>时，默认为100%。
            </div>
        </div>

        <!-- 命破伤害 -->
        <div class="formula-section">
            <h2>命破伤害</h2>
            <p class="description">
                命破伤害基于角色的生命值和攻击力，与防御无关，而是与贯穿相关。
            </p>
            <div class="formula-box">
                <div class="math">
                    $$\begin{align}
                    \text{贯穿力} &= \frac{\text{生命值}}{10} + \frac{3 \times \text{攻击力}}{10}  \\
                    \text{命破伤害} &= \text{通用伤害(贯穿力)} \times (1 + \text{易伤}\% - \text{减伤}\%) \\
                        \quad &\times (1 + \text{贯穿增伤}\% - \text{贯穿减伤}\%)
                    \end{align}$$
                </div>
            </div>
        </div>

        <!-- 异常伤害 -->
        <div class="formula-section">
            <h2>异常伤害</h2>
            <p class="description">
                异常伤害包括<span class="qiangjie">强击</span>、<span class="suibing">碎冰</span>、<span class="zhuoshao">灼烧</span>、<span class="gandian">感电</span>、<span class="qinshi">侵蚀</span>等异常状态造成的伤害。
            </p>
            <div class="formula-box">
                <div class="math">
                    $$\begin{align}
                    \text{异常伤害} &= \text{通用伤害(攻击力)} \times \frac{异常精通}{100} \times \text{防御区} \\
                    \quad &\times \underbrace{trunc(1 + \frac{\text{等级} - 1}{59}, 4)}_{\text{保留小数函数}} \\
                    \quad &\times (1 + \text{异常增伤}\% + \text{异常易伤}\%) \\
                    \end{align}$$
                </div>
            </div>
            <h3>异常倍率表</h3>
            <table>
                <tr>
                    <th>异常类型</th><th>倍率</th><th>次数</th><th>频率</th>
                </tr>
                <tr>
                    <td><span class="qiangjie">强击</span></td><td>713%</td><td>1</td><td></td>
                </tr>
                <tr>
                    <td><span class="suibing">碎冰</span></td><td>500%</td><td>1</td><td></td>
                </tr>
                <tr>
                    <td><span class="zhuoshao">灼烧</span></td><td>50%</td><td>20</td><td>0.5 sCD</td>
                </tr>
                <tr>
                    <td><span class="gandian">感电</span></td><td>125%</td><td>10</td><td>1 hit/1 sCD</td>
                </tr>
                <tr>
                    <td><span class="qinshi">侵蚀</span></td><td>62.5%</td><td>20</td><td>1 hit/0.5 sCD</td>
                </tr>
            </table>
        </div>

        <!-- 异常积蓄值 -->
        <div class="formula-section">
            <h2>异常积蓄值</h2>
            <p class="description">
                异常积蓄值决定了激发异常所需的操作次数。
            </p>
            <div class="formula-box">
                <div class="math">
                    $$\begin{align}
                    \text{异常积蓄值} &= \text{基础积蓄值} \times \frac{\lfloor \text{异常掌控} \rfloor}{100} \\
                    \quad &\times (1 + \text{积蓄效率提升}\% - \text{积蓄效率降低}\% + \text{积蓄值提升}) \\
                    \quad &\times (1 - \text{积蓄抗性提升}\% + \text{积蓄抗性减少}\%) \times \text{距离衰减区} \\
                    
                    \text{异常积蓄阈值} &=
                    \begin{cases}
                        a_1 = 600 \times 1.2 \text{(物理)} \\
                        a_{n+1} = \lfloor 1.05 \times a_n \rfloor, & 1 \leq n \leq 9
                        \tag{n为触发次数} \\
                    \end{cases} \\

                    \text{普通:精英:首领} &= 600:2250:3000
                    \end{align}$$
                </div>
            </div>
            <h3>异常积蓄阈值</h3>
            <table>
                <tr>
                    <th>已触发次数</th>
                    <th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9+</th>
                </tr>
                <tr>
                    <td>普通敌人</td>
                    <td>600</td><td>612</td><td>624</td><td>636</td><td>648</td><td>660</td><td>673</td><td>686</td><td>699</td><td>712</td>
                </tr>
                <tr>
                    <td>普通敌人<br/>(物理)</td>
                    <td>720</td><td>734</td><td>748</td><td>762</td><td>777</td><td>792</td><td>807</td><td>823</td><td>839</td><td>855</td>
                </tr>
                <tr>
                    <td>精英敌人</td>
                    <td>2250</td><td>2295</td><td>2340</td><td>2386</td><td>2433</td><td>2481</td><td>2530</td><td>2580</td><td>2631</td><td>2683</td>
                </tr>
                <tr>
                    <td>精英敌人<br/>(物理)</td>
                    <td>2700</td><td>2754</td><td>2809</td><td>2865</td><td>2922</td><td>2980</td><td>3039</td><td>3099</td><td>3160</td><td>3223</td>
                </tr>
                <tr>
                    <td>首领敌人</td>
                    <td>3000</td><td>3060</td><td>3121</td><td>3183</td><td>3246</td><td>3310</td><td>3376</td><td>3443</td><td>3511</td><td>3581</td>
                </tr>
                <tr>
                    <td>首领敌人<br/>(物理)</td>
                    <td>3600</td><td>3672</td><td>3745</td><td>3819</td><td>3895</td><td>3972</td><td>4051</td><td>4132</td><td>4214</td><td>4298</td>
                </tr>
            </table>
            <div class="note">
                <strong>注意：</strong>大部分代理人计算<strong>距离衰减区</strong>时，默认为100%。
            </div>
        </div>

        <!-- 紊乱 -->
        <div class="formula-section">
            <h2>紊乱</h2>
            <div class="formula-box">
                <div class="math">
                    $$\begin{align}
                    \quad & \text{未作特别说明时，紊乱无法享受异常增伤区} \\
                    \\
                    \quad & \text{伤害倍率} = 450 \% +
                    \begin{cases}
                        \quad &7.5 \% \times \lfloor t \rfloor \quad & , \color{#F0D12B}{\text{畏缩}} \\
                        \quad &7.5 \% \times \lfloor t \rfloor \quad & , \color{#98EFF0}{\text{霜寒}} \\
                        \quad &75 \% \times \lfloor t + 2 \rfloor \quad & , \color{#98EFF0}{\text{霜寒·烈霜}} \\
                        \quad &50 \% \times \frac{\lfloor t \rfloor}{0.5} \quad & , \color{#FF5521}{\text{灼烧}} \\
                        \quad &125 \% \times \lfloor t \rfloor \quad & , \color{#2EB6FF}{\text{感电}} \\
                        \quad &62.5 \% \times \frac{\lfloor t \rfloor}{0.5} \quad & , \color{#FE437E}{\text{侵蚀}} \\
                        \tag{t为剩余时间}
                    \end{cases}\\
                    \\
                    \quad & \text{失衡倍率} = 200 \%
                    \end{align}$$
                </div>
            </div>
        </div>

        <!-- 加权规则 -->
        <div class="formula-section">
            <h2>加权规则</h2>
            <div class="formula-box">
                <div class="math">
                    $$\text{对于异常伤害、异常积蓄和紊乱失衡积蓄来说，最后结算时会按照此刻攻击的贡献所占对应状态的百分比参与结算} \\$$
                </div>
                <div class="math">
                    $$\text{异常伤害参与加权的属性有：等级、攻击力、精通区、穿透率、穿透值、增伤区、异常增伤区} \\$$
                </div>
                <div class="math">
                    $$\text{异常积蓄参与加权的属性有：异常积蓄值} \\$$
                </div>
                <div class="math">
                    $$\text{紊乱失衡积蓄参与加权的属性有：等级} (1 + 0.0075 \times lv) \text{、冲击力、失衡效率区} \\$$
                </div>
                <div class="math">
                    $$\quad \text{积蓄值百分比} = \frac{\text{此刻攻击积蓄值}}{\text{总积蓄值} - \text{邦布累计积蓄值}} \times 100 \%$$
                </div>
            </div>
        </div>

        <!-- 失衡值 -->
        <div class="formula-section">
            <h2>失衡值</h2>
            <p class="description">
                失衡值决定了角色对敌人造成的失衡累积程度。
            </p>
            <div class="formula-box">
                <div class="math">
                    $$\begin{align}
                    \text{失衡值} &= \text{冲击力} \times \text{失衡倍率} \times (1 - \text{失衡抗性} \%) \\
                        \quad &\times (1 + \text{造成的失衡值提升} - \text{造成的失衡值降低}) \\
                        \quad &\times (1 + \text{受到的失衡值提升} - \text{受到的失衡值降低}) \\
                        \quad &\times \text{距离衰减区}
                    \end{align}$$
                </div>
            </div>
        </div>

        <!-- 距离衰减区 -->
        <div class="formula-section">
            <h2>距离衰减区</h2>
            <div class="formula-box">
                <div class="math">
                    $$\text{目前只有部分代理人会受到该乘区影响：默认型、格莉丝型、扳机型、耀嘉音型} \\$$
                </div>
                <div class="math">
                    $$\text{距离衰减区} =
                    \begin{cases}
                        25 \% + 25 \% \times
                        \lfloor \frac{d-15}{5} \rfloor \quad & , d \geq 15m && \text{比利、丽娜、朱鸢等} \\
                        30 \% \quad & , d \geq 15m && \text{格莉丝} \\
                        100\% \quad & && \text{其他代理人}
                        \tag{d为敌我距离}
                    \end{cases}$$
                </div>
            </div>
        </div>
    </main>

    <!-- 延迟加载业务脚本，避免阻塞渲染 -->
    <script src="./script.js" defer></script>
</body>

</html>
